<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox — MarketDump Writeup | B3nnyQ InfoSec</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="HackTheBox — MarketDump Writeup" /><meta name="author" content="BenQ" /><meta property="og:locale" content="en_US" /><meta name="description" content="We have got informed that a hacker managed to get into our internal network after pivoting through the web platform that runs in public internet. He managed to bypass our small product stocks logging platform and then he got our costumer database file. We believe that only one of our costumers was targeted. Can you find out who the customer was?" /><meta property="og:description" content="We have got informed that a hacker managed to get into our internal network after pivoting through the web platform that runs in public internet. He managed to bypass our small product stocks logging platform and then he got our costumer database file. We believe that only one of our costumers was targeted. Can you find out who the customer was?" /><link rel="canonical" href="https://b3nnyq.github.io/b3nnyq//posts/MarketDump/" /><meta property="og:url" content="https://b3nnyq.github.io/b3nnyq//posts/MarketDump/" /><meta property="og:site_name" content="B3nnyQ InfoSec" /><meta property="og:image" content="https://b3nnyq.github.io/b3nnyq//assets/img/Posts/MarketDump.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-27T20:58:00+11:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://b3nnyq.github.io/b3nnyq//assets/img/Posts/MarketDump.png" /><meta property="twitter:title" content="HackTheBox — MarketDump Writeup" /><meta name="twitter:site" content="@b3nnyq" /><meta name="twitter:creator" content="@BenQ" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"BenQ"},"description":"We have got informed that a hacker managed to get into our internal network after pivoting through the web platform that runs in public internet. He managed to bypass our small product stocks logging platform and then he got our costumer database file. We believe that only one of our costumers was targeted. Can you find out who the customer was?","@type":"BlogPosting","headline":"HackTheBox — MarketDump Writeup","dateModified":"2020-10-27T20:58:00+11:00","datePublished":"2020-10-27T20:58:00+11:00","image":"https://b3nnyq.github.io/b3nnyq//assets/img/Posts/MarketDump.png","url":"https://b3nnyq.github.io/b3nnyq//posts/MarketDump/","mainEntityOfPage":{"@type":"WebPage","@id":"https://b3nnyq.github.io/b3nnyq//posts/MarketDump/"},"@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">B3nnyQ InfoSec</a></div><div class="site-subtitle font-italic">CTF Player | Digital Forensics | InfoSec Enthusiast.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/b3nnyq" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/b3nnyq" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['b','gmail.com'].join('@')" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HackTheBox — MarketDump Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox — MarketDump Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 27, 2020, 8:58 PM +1100" > Oct 27 <i class="unloaded">2020-10-27T20:58:00+11:00</i> </span> by <span class="author"> BenQ </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 27, 2020, 10:02 PM +0800" > Oct 27 <i class="unloaded">2020-10-28T01:02:47+11:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump.png" class="post-preview-img"><blockquote><p>We have got informed that a hacker managed to get into our internal network after pivoting through the web platform that runs in public internet. He managed to bypass our small product stocks logging platform and then he got our costumer database file. We believe that only one of our costumers was targeted. Can you find out who the customer was?</p></blockquote><h1 id="task-overview">Task Overview</h1><ul><li>1<li>2<li>3<h2 id="initial-analysis">Initial Analysis</h2></ul><p>Looking over the protocol hierarchy we see that a majority of the network traffic occurs over the TCP, in particular HTTP and an unreckognised Data.</p><p>Therefore, lets take a look at what WireShark did not categorise.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump/protocol.png" alt="protocol" /></p><p>Applying the filter to the identified protocol, we look at the conversations taking place:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump/convo.png" alt="conversations" /></p><p>We see that there was some traffic between the host <code class="language-plaintext highlighter-rouge">10.0.2.3</code> and <code class="language-plaintext highlighter-rouge">10.0.2.15</code>. Lets take a look a further look.</p><h2 id="host-compromise-tcp">Host Compromise (TCP)</h2><p>The first bit of traffic shows some ping requests between the aforementioned hosts. Proceeding this the unidentified host <code class="language-plaintext highlighter-rouge">10.0.2.15:34976</code> establishes a connection to <code class="language-plaintext highlighter-rouge">10.0.2.3:9999</code>.</p><p>Following the TCP stream we can see that we have located the C2, with the adversary attempting to locate the customer database file. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump/tcpstream1.png" alt="tcpstream1" /></p><p>After quickly scanning through it was immediately obvious which customer was targetted and I looked for further C2 between the machines. With no luck I took another look at the output and noticed:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump/tcpstream2.png" alt="tcpstream2" /></p><p>Here we can see on the customer numbers has some encoding or encryption. I wasn’t familiar immediatly so I utilise <code class="language-plaintext highlighter-rouge">CyberChef.com</code> and the magic wand predicts Base58:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/Posts/MarketDump/flag.png" alt="flag" /></p><p>And we have the flag! BQ</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/challenges/'>Challenges</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pcap/" class="post-tag no-text-decoration" >pcap</a> <a href="/tags/wireshark/" class="post-tag no-text-decoration" >wireshark</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >forensics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox — MarketDump Writeup - B3nnyQ InfoSec&url=https://b3nnyq.github.io/b3nnyq//posts/MarketDump/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox — MarketDump Writeup - B3nnyQ InfoSec&u=https://b3nnyq.github.io/b3nnyq//posts/MarketDump/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox — MarketDump Writeup - B3nnyQ InfoSec&url=https://b3nnyq.github.io/b3nnyq//posts/MarketDump/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CTFDownTheRabbitHole/">CTF — Down The Rabbit Hole</a><li><a href="/posts/Cheatsheetpass/">Cheatsheet — Password Cracking</a><li><a href="/posts/Optimum/">HackTheBox — Optimum Writeup</a><li><a href="/posts/Shocker/">HackTheBox — Shocker Writeup</a><li><a href="/posts/MarketDump/">HackTheBox — MarketDump Writeup</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/binwalk/">binwalk</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/cyberchef/">CyberChef</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/hashes/">hashes</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/inprogress/">inprogress</a> <a class="post-tag" href="/tags/john/">john</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/FriendZone/"><div class="card-body"> <span class="timeago small" > Oct 26 <i class="unloaded">2020-10-26T20:58:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — FriendZone Writeup</h3><div class="text-muted small"><p> FriendZone executive summary goes here … to-do Task Overview Recon To-do To-do Reconnaissance Starting with an masscan and nmap to find the open ports and services on 10.10.10.123: ...</p></div></div></a></div><div class="card"> <a href="/posts/Shocker/"><div class="card-body"> <span class="timeago small" > Oct 27 <i class="unloaded">2020-10-27T21:58:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — Shocker Writeup</h3><div class="text-muted small"><p> Shocker executive summary goes here … to-do Task Overview Task in progress Reconnaissance Starting with an masscan and nmap to find the open ports and services on 10.10.10.56: 1 2 3 4 ...</p></div></div></a></div><div class="card"> <a href="/posts/Netmon/"><div class="card-body"> <span class="timeago small" > Oct 28 <i class="unloaded">2020-10-28T09:58:00+11:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox — Netmon</h3><div class="text-muted small"><p> Netmon windows machine by HackTheBox.com partial guide for root. Priv Esc For my own notes I have recorded steps for root only. We find an RCE exploit ready to go on www.exploit-db.com 1 2 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FriendZone/" class="btn btn-outline-primary"><p>HackTheBox — FriendZone Writeup</p></a> <a href="/posts/Shocker/" class="btn btn-outline-primary"><p>HackTheBox — Shocker Writeup</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com/b3nnyq">B3nnyQ</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> <script src="https://www.hackthebox.eu/badge/226304"></script></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/binwalk/">binwalk</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/cyberchef/">CyberChef</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/hashes/">hashes</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/inprogress/">inprogress</a> <a class="post-tag" href="/tags/john/">john</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://b3nnyq.github.io/b3nnyq/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
